# Run_analysis Code Book

This code book describes the analysis done in Run_analysis.R 

The input raw data are available at 
https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip

The output is the *step5_summary.txt* summary file

### Step by Step Description

The needed packages were loaded and the working directory was set using
```{r}
library(dplyr)
setwd("/Users/hx2/Downloads/UCI HAR Dataset")
```

*xtest_path* is the filepath to test data
*ytest_path* is the filepath to test data activity label
*subject_test_path* is the filepath to test data subject label

Using *read.table* function, the files are read as dataframes *xtest*, *ytest*,
*subjecttest* respectively
```{r}
xtest <- read.table(xtest_path, sep = "")
ytest <- read.table(ytest_path, sep = "")
subjecttest <- read.table(subject_test_path)
```
Then, the *subjecttest*(2947 obs. of 1 variable), *ytest*(2947 obs. of 1 variable), and *xtest* (2947 obs of 561 variables) were horizontally merged to to make a *testcomposite* dataframe of 2947 obs. of 563 variables
```{r}
testcomposite <- cbind(subjecttest, ytest, xtest)
```

Similarly, the training data composite *traincomposite*(7352 obs. of 563 variables) were also made
```{r}
# reading training data  
xtrain_path <- "./train/X_train.txt"
ytrain_path <- "./train/y_train.txt"
subject_train_path <- "./train/subject_train.txt"
xtrain <- read.table(xtrain_path, sep = "")
ytrain <- read.table(ytrain_path, sep = "")
subjecttrain <- read.table(subject_train_path, sep = "")
traincomposite <- cbind(subjecttrain, ytrain, xtrain)
```

******

**(Project Requirement 1)**

The training data and test data were vertically concatenated

```{r}
# merging test and training data
composite <- rbind(testcomposite,traincomposite)
```

******

**(Project Requirement 4)**

*features.txt* file was read in and used as column labels for the composite data frame

Note: Column 1 (subject) & 2(y) were named to *subject* and *activity*


```{r}
# reading names of features as character array
feature_path <- "./features.txt"
feature <- read.table(feature_path, sep = "")[,2]

# labeling the variables with appropriate names
colnames(composite) <- c("subject", "activity", feature)
```

******

**(Project Requirement 2)**

Using *grep()* function, column names containing "subject","activity", "mean", or "std" were selected

*select_criteria* is an array of desired column index numbers

The resulting *composite* is now 10299 obs. of 81 variables

```{r}
# Extracting only mean and standard deviation 
select_criteria <- grep("subject|activity|mean|std", names(composite))
composite <- composite[,select_criteria]
```
******

**(Project Resuirement 3)**

*activity.txt* was read in as a 6 obs. of 2 variables array that describes the activities tracked. i.e. 1 == Walking, 2 == Walking Upstairs etc.

using *as.factor()* function, the activity column of the *composite* data frame was changed from numeric to factor format. 

*levels()* function then calls out the levels of *activity* column and have them renamed to string factors describing the activities

```{r}
# labeling activity with descriptive factors
activity_path <- "./activity_labels.txt"
activity <- read.table(activity_path, sep = "")
composite$activity <- as.factor(composite$activity)
levels(composite$activity) <- activity[,2]
```

******

**(Project Requirment 5)**
Lastly, a new table called *table_summary* was generated by piping *composite* data frame, grouping it by *subject* and *activity*, then calculating the mean using *summarise_all()* all funtion. 
```{r}
# summarizing the average of each variable for each activity and each subject
table_summary <- composite %>%
  group_by(subject,activity) %>%
  summarise_all(mean) %>%
  ungroup()
```

The *table_summary* was then written into a ".txt" file and uploaded as *step5_summary.txt*
```{r}
# writing the result into a .txt file
write.table(table_summary,file = "./step5_summary.txt",row.names = F)

#checking the resulting file can be read
checkresult <- read.table('./step5_summary.txt', sep = "")
```